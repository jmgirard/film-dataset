---
title: "Akeelah and the Bee"
---

```{r}
#| echo: false
#| message: false

library(tidyverse)
library(lubridate)
library(readxl)
library(varde)
library(ggbeeswarm)
library(knitr)
library(kableExtra)

s_to_mmss <- function(s) {
  p <- seconds_to_period(s)
  sprintf("%02d:%02d", minute(p), second(p))
}
```

## Film Information

::: columns
::: {.column width="70%"}
***Akeelah and the Bee*** is a 2006 American drama film written and directed by Doug Atchison. It tells the story of Akeelah Anderson (Keke Palmer), an 11-year-old girl who participates in the Scripps National Spelling Bee, her mother (Angela Bassett), her schoolmates, and her coach, Dr. Joshua Larabee (Laurence Fishburne). The cast also features Curtis Armstrong, J.R. Villarreal, Sean Michael Afable, Erica Hubbard, Lee Thompson Young, Julito McCullum, Sahara Garey, Eddie Steeples, and Tzi Ma.\

The credits for the film read, "A Lionsgate, 2929 Productions and Starbucks Entertainment presentation of an Out of the Blue and Reactor Films production in association with Cinema Gypsy Productions."
:::
::: {.column width="10%"}
:::
::: {.column width="20%"}
![](./img/akeelah_poster.jpg)
:::
:::

> All information in this section came directly from [Wikipedia](https://en.wikipedia.org/wiki/Akeelah_and_the_Bee).

## Clip Information

Textual description of what happens in the clip...

```{r}
#| echo: false

ratings <- 
  read_rds("./data/ratings_tidy.rds") |>
  drop_na(Rating) |> 
  rename(Abbrev = Film) |> 
  mutate(Abbrev = str_remove_all(Abbrev, "'")) |> 
  filter(Abbrev == "Akeelah")

films <- 
  read_xlsx("./data/film_info.xlsx") |> 
  filter(Abbrev == "Akeelah")

panas <- 
  read_rds("./data/panas_tidy.rds") |> 
  drop_na(val) |> 
  rename(Abbrev = clip) |> 
  mutate(Abbrev = str_remove_all(Abbrev, "'"), val = val - 1) |> 
  filter(Abbrev == "Akeelah")
```

```{r}
#| echo: false

films |> 
  kable() |> 
  kable_styling()
```

## Holistic Ratings

A total of `r length(unique(panas$rater))` participants watched this film clip and then provided holistic ratings on how the entire clip made them feel. These holistic ratings were completed using five positive emotion scales (i.e., *alert*, *determined*, *enthusiastic*, *excited*, *inspired*) and five negative emotion scales (i.e., *afraid*, *distressed*, *nervous*, *scared*, *upset*), each rated on an ordinal scale from 0 to 4.

```{r}
#| echo: false
#| message: false
#| fig-width: 7
#| fig-height: 4
#| out-width: "100%"

pa <- c("Inspired", "Excited", "Enthusiastic", "Determined", "Alert")
na <- c("Nervous", "Afraid", "Distressed", "Scared", "Upset")

panas |> 
  mutate(
    valence = case_when(
      scale %in% pa ~ "Positive",
      scale %in% na ~ "Negative"
    )
  ) |> 
  ggplot(
    aes(x = val, y = fct_reorder(scale, val, .fun = mean), fill = valence)
  ) + 
  stat_summary(geom = "col", fun = mean, orientation = "y") +
  stat_summary(geom = "pointrange", fun.data = mean_cl_boot, linewidth = 0.6) +
  scale_x_continuous(limits = c(0, 4)) +
  labs(y = NULL, x = "Average Rating with 95% CI", fill = "Scale") +
  theme(legend.position = "top")
```

As seen in the figure above, participants rated all positive emotion scales higher than all negative emotion scales. Ratings of *inspired*, *excited*, and *enthusiastic* were particularly high. Among the negative emotion scales, ratings of *nervous* were relatively high.


## Continuous Ratings

A total of `r length(unique(panas$rater))` participants watched this film clip and used the [CARMA software](https://carma.jmgirard.com) to provide continuous (i.e., second-by-second) ratings of how it made them feel. These continuous ratings were made on a single emotional *valence* scale ranging from -4 (very negative) to 4 (very positive).

### Inter-Rater Reliability

```{r}
#| echo: false
#| message: false

icc_res <- 
  calc_icc(
    ratings, 
    subject = "Second", 
    rater = "Rater", 
    score = "Rating",
    iter = 10000,
    file = "icc_akeelah",
    silent = 2,
    subject_label = "Timepoint"
  )
```

A Bayesian generalizability study was used to decompose the variance in ratings of this video clip into the following components: timepoint variance (in average ratings of each second, across raters), rater variance (in average ratings from each rater, across seconds), and residual variance (including second-by-rater interactions and measurement error). Timepoint variance was estimated at `r round(icc_res$summary$est[1], 2)`, 95\% ETI: [`r round(icc_res$summary$lower[1], 2)`, `r round(icc_res$summary$upper[1], 2)`]; rater variance was estimated at `r round(icc_res$summary$est[2], 2)` [`r round(icc_res$summary$lower[2], 2)`, `r round(icc_res$summary$upper[2], 2)`]; and residual variance was estimated at `r round(icc_res$summary$est[3], 2)`  [`r round(icc_res$summary$lower[3], 2)`, `r round(icc_res$summary$upper[3], 2)`]. See the figure below for the posterior distributions of each component.

```{r}
#| echo: false
#| fig-width: 7
#| fig-height: 2
#| out-width: "100%"

plot(icc_res, components = "var")
```

From these variance components, we can estimate inter-rater reliability of the ratings. There are many formulations of the two-way intraclass correlation (ICC), but the most relevant to our purposes here is the balanced average-measures consistency formulation or ICC(C,k). Inter-rater reliability under this formulation was estimated as `r round(icc_res$summary$est[8], 3)`, 95% ETI: [`r round(icc_res$summary$lower[8], 3)`, `r round(icc_res$summary$upper[8], 3)`]. See the middle of the second row in the figure below for the posterior distribution of this formulation.

```{r}
#| echo: false
#| fig-width: 7
#| fig-height: 4
#| out-width: "100%"

plot(icc_res, components = "icc")
```


### Time Series

We can plot the distribution of all valence ratings per second of the film clip to get a sense of how its emotional tone changes over time. The solid black line represents the mean of all ratings and the yellow, green, and purple ribbons represent the central 50%, 70%, and 90% of the ratings, respectively.

```{r}
#| echo: false
#| fig-width: 7
#| fig-height: 5
#| out-width: "100%"

ggplot(ratings, aes(x = Second, y = Rating)) +
  stat_summary(
    geom = "ribbon",
    fun.data = "median_hilow",
    fun.args = list(conf.int = .9),
    fill = "#440154"
  ) +
  stat_summary(
    geom = "ribbon",
    fun.data = "median_hilow",
    fun.args = list(conf.int = .7),
    fill = "#21908c"
  ) +
  stat_summary(
    geom = "ribbon",
    fun.data = "median_hilow",
    fun.args = list(conf.int = .5),
    fill = "#fde725"
  ) +
  geom_hline(yintercept = 0, color = "grey", linewidth = 3/4) +
  stat_summary(
    geom = "line", 
    fun = mean, 
    na.rm = TRUE, 
    linewidth = 3/4
  ) +
  scale_x_continuous(
    breaks = seq(0, 180, 30), 
    expand = c(0, 0),
    labels = s_to_mmss
  ) +
  scale_y_continuous(expand = c(0, 0)) +
  coord_cartesian(ylim = c(-4, 4), xlim = c(0, 165)) +
  labs(y = "Valence Rating", x = NULL)
```

## Watch Clip

{{< video https://filmdataset.s3.us-east-2.amazonaws.com/Clips/Akeelah.mp4 title="Akeelah Clip" >}}
